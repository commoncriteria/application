<?xml version="1.0" encoding="utf-8"?>
<technical-decisions  xmlns:h="http://www.w3.org/1999/xhtml" 
		      xmlns="https://niap-ccevs.org/cc/v1">
  <bunch>
    <applies-to max-inclusive="1.3" name="Protection Profile for Application Software"/>

    <decision id='0486'>
    	<notes>Removal of PP-Module for VPN Clients from allowed with list</notes>

        <change xpath=".//chapter[@id='ccl']" mode="replace">
    <chapter title="Conformance Claims" id="ccl" boilerplate="no">
    <cclaims>
      <cclaim id="Conformance Statement">
        <description>An ST must claim exact conformance to this PP, as defined in the CC and CEM addenda for Exact Conformance, 
		 Selection-Based SFRs, and Optional SFRs (dated May 2017).</description>
      </cclaim>
      <cclaim id="CC Conformance Claims">
        <description>This PP is conformant to Parts 2 (extended) and 3 (extended) of Common Criteria Version 3.1, Revision 5.</description>
      </cclaim>
      <cclaim id="PP Claim">
        <description>This PP does not claim conformance to any other Protection Profile.
	       <h:br/><h:br/>
	       The following PPs and PP-Modules are allowed to be specified in a PP-Configuration with this PP. 
		 <h:br/>
		<indent><h:li>PP-Module for File Encryption, Version 1.0</h:li></indent>
		 <h:br/>
		<indent><h:li>PP-Module for File Encryption Enterprise Management, Version 1.0</h:li></indent>
        </description>
      </cclaim>
      <cclaim id="Package Claim">
        <description>This PP is TLS Package Version 1.1 Conformant.</description>
      </cclaim>
    </cclaims>
    </chapter>
	</change>

        <change xpath=".//f-element[@id='fdp_dar_ext.1.1']" mode="replace">
          <f-element id="fdp_dar_ext.1.1">
            <title>The application shall 
	      <selectables linebreak="yes">
                <selectable>leverage platform-provided functionality to encrypt sensitive data</selectable>
                <selectable>implement functionality to encrypt sensitive data as defined in the PP-Module for File Encryption</selectable>
	              <selectable>protect sensitive data in accordance with <linkref linkend="FCS_STO_EXT.1"/></selectable>
                <selectable>not store any sensitive data</selectable>
              </selectables>
              in non-volatile memory.
            </title>
            <note role="application">
			  If <h:i>implement functionality to encrypt sensitive data as defined in the PP-Module for File Encryption</h:i> is selected, 
		    the TSF must claim conformance to a PP-Configuration that includes the File Encryption PP-Module. 
			  <h:br/>
              Any file that may potentially contain sensitive data (to include temporary files)
              shall be protected.  The only exception is if the user intentionally exports the sensitive data
              to non-protected files. ST authors should select <h:i>protect sensitive data in accordance with 
              <linkref linkend="FCS_STO_EXT.1"/></h:i> for the 
              sensitive data that is covered by the <linkref linkend="FCS_STO_EXT.1"/> SFR.
	    </note>
            <aactivity>
              <TSS/>
              The evaluator shall examine the TSS to ensure that it describes the sensitive data processed by the application. 
              The evaluator shall then ensure that the following activities cover all of the sensitive data identified in the TSS.
              <h:br/>
             If <h:b>not store any sensitive data</h:b> is selected, the evaluator shall inspect the TSS to ensure 
              that it describes how sensitive data cannot be written to non-volatile memory. The evaluator shall also 
              ensure that this is consistent with the filesystem test below.
              <h:br/><h:br/>
        
              <Guidance/> None. <h:br/><h:br/>   
              <Tests/><h:br/>
              Evaluation activities (after the identification of the sensitive data) are to be performed on all sensitive data listed 
              that are not covered by <linkref linkend="FCS_STO_EXT.1"/>.
              <h:br/>
              
              
              The evaluator shall inventory the filesystem locations where the application may write data. 
              The evaluator shall run the application and attempt to store sensitive data. The evaluator shall 
              then inspect those areas of the filesystem to note where data was stored (if any), and determine 
              whether it has been encrypted.
              
              <h:br/>
              If <h:b>leverage platform-provided functionality</h:b> is selected, the evaluation activities will be performed as 
              stated in the following requirements, which vary on a per-platform basis.
              <h:br/>
			                <subaactivity platform="android">
		        The evaluator shall inspect the TSS and verify that it describes how files containing sensitive data are 
                stored with the <h:code>MODE_PRIVATE</h:code> flag set.
	          </subaactivity>
              <subaactivity platform="windows">The Windows platform currently does not provide data-at-rest
                encryption services which depend upon invocation by application developers. The evaluator shall
                verify that the Operational User Guidance makes the need to activate platform encryption, 
                such as BitLocker or Encrypting File System (EFS), clear to the end user.
              </subaactivity>
              <subaactivity platform="ios">The evaluator shall inspect the TSS and ensure that it describes how the 
                application uses the Complete Protection, Protected Unless Open, or Protected Until 
                First User Authentication Data Protection Class for each data file stored locally. 
              </subaactivity>
              <subaactivity platform="linux">
               The Linux platform currently does not provide data-at-rest encryption services which depend
               upon invocation by application developers.  The evaluator shall verify that
               the Operational User Guidance makes the need to activate platform encryption clear 
               to the end user.
	      </subaactivity>
              <subaactivity platform="Solaris">
               The Solaris platform currently does not provide data-at-rest encryption services which depend
               upon invocation by application developers.  The evaluator shall verify that
               the Operational User Guidance makes the need to activate platform encryption clear 
               to the end user.
	      </subaactivity>
              <subaactivity platform="mac">
               The macOS platform currently does not provide data-at-rest encryption services which depend
               upon invocation by application developers.  The evaluator shall verify that
               the Operational User Guidance makes the need to activate platform encryption clear
               to the end user.
	      </subaactivity>
            </aactivity>
          </f-element>
	</change>
    </decision>
  </bunch>
</technical-decisions>
