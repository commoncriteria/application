<?xml version="1.0" encoding="utf-8"?>
<technical-decisions  xmlns:h="http://www.w3.org/1999/xhtml" 
		      xmlns="https://niap-ccevs.org/cc/v1">
  <bunch>
    <applies-to max-inclusive="1.3" name="Protection Profile for Application Software"/>

    <decision id='0495'>
    	<notes>FIA_X509_EXT.1.2 Test Clarification</notes>

        <change xpath=".//f-element[@id='fia_x509_ext.1.2']" mode="replace">
          <f-element id="fia_x509_ext.1.2">
            <title>
              The application shall treat a certificate as a CA certificate only if the 
              basicConstraints extension is present and the CA flag is set to TRUE.
            </title>
            <note role="application">
              This requirement applies to certificates that are used and processed by the 
              <abbr title="TOE Security Functionality" linkend="TSF">TSF</abbr> and restricts the certificates that may be added as trusted CA 
              certificates.
            </note>
            <aactivity>
              <TSS/>None.
		    <Guidance/>None.
              <Tests/>
		    The tests described must be performed in conjunction with the other certificate 
              services evaluation activities, including the functions in <linkref linkend="FIA_X509_EXT.2.1"/>. 
	      If the application supports chains of length four or greater, 
	      the evaluator shall create a chain of at least four certificates: the 
              node certificate to be tested, two Intermediate CAs, and the self-signed Root CA.
	      If the application supports a maximum trust depth of two, then a chain with
	      no Intermediate CA should instead be created.
	      
              <testlist>
                <test>
                  The evaluator shall ensure that the certificate of at least one of the 
                  CAs in the chain does not contain the 
                  basicConstraints extension. The evaluator shall confirm that validation of the certificate path fails (i) as part of the validation of the peer certificate belonging to this chain; and/or (ii) when attempting to add the CA certificate without the basicConstraints extension to the TOE's trust store.
                </test>
                <test>
                  The evaluator shall ensure that the certificate of at least one of the 
                  CAs in the chain has the CA flag in the 
                  basicConstraints extension not set (or set to FALSE). The evaluator shall confirm that validation of the certificate path fails (i) as part of the validation of the peer certificate belonging to this chain; and/or (ii) when attempting to add the CA certificate with the CA flag not set (or set to FALSE) in the basicConstraints extension to the TOE's trust store.
                </test>
              </testlist> 
            </aactivity>
          </f-element>
	</change>
    </decision>
  </bunch>
</technical-decisions>
